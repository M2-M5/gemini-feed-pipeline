name: Run Gemini Feed Pipeline

on:
  workflow_dispatch:

jobs:
  run-feed-pipeline:
    if: github.actor == 'M2-M5'  # Replace with your GitHub username
    runs-on: [self-hosted,Windows,X64]

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Run feed generation
        run: python src/generate_feeds.py
      - name: Run feed validation
        run: python src/validate_feeds.py output/gt_account_feed.csv output/gt_glossary_feed.csv

      - name: Archive output
        run: |
          mkdir -Force output/archive
          Copy-Item output/*.csv output/archive/